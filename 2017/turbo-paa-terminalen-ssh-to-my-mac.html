<!DOCTYPE html>
<html lang="da">
<head>
 <meta charset="utf-8">
 <title>Turbo p&aring; Terminalen - ssh To My Mac
 | logiskhave</title>
 <meta name="description" content="Log ajourf&oslash;rt af Kresten Jacobsen.">
 <meta name="viewport" content="width=720">
 <link rel="icon" href="/static/favicon.ico">
 <link rel="apple-touch-icon" href="/static/apple-touch-icon.jpg"/>
 <link rel="stylesheet" href="/css/theme.css" type="text/css">
 <link rel="alternate" type="application/rss+xml" title="" href="/rss.xml">
</head>
<body>
    <div id="container">
        <div id="header">
            <h1><span>Jeg er</span> <a title="Kolofon" href="/colophon.html">Kresten Jacobsen.</a> <span>Dette er</span> <a title="Log" href="/"> min log.</a></h1>
        </div><!-- /header --><div class="post">
		<p class="date">22. Marts, 2017</p>
    	<h2>
            
                Turbo p&aring; Terminalen - ssh To My Mac

            
        </h2>
       	<p><a href="http://en.wikipedia.org/wiki/Wikipedia:Too_long;_didn't_read">TL;DR</a> - Jeg har lavet et lille <a href="">script</a>, der tillader at man ssh'er tilbage til sin Mac uden at rode med routere, portforwarding ol. Alt det kræver er at Back To My Mac er aktiveret på begge maskiner.</p>
<p><img src="https://log.logiskhave.dk/static/20170322-icloud-icon-ssh.png" alt="iCloud+SSH" style="width: 200px;"></p>
<p>Nogle gange har jeg brug for at kunne forbinde til min hjemme-mac og har hidtil gjort det via 'screen sharing' via 'Back To My Mac'. Det virker egentligt også fint, men som oftest har jeg slet ikke brug for den grafiske brugergrænseflade som skærmdeling giver mig. Jeg har bare brug for en terminal-adgang. Derfor ville jeg faktisl helst ssh'e mig ind til min maskine. Men jeg gider ikke rigtig rode med 'port forwarding' og åbne (mere) op til mit hjemmenetværk i min router. Så jeg kom til at tænke på, om man mon ikke kunne udnytte Back To My Mac-forbindelsen til dette formål. Og jo, efter 10 sekunder på <a href="https://duckduckgo.com/?q=Remote+SSH+using+Back+To+My+Mac">duckduckgo</a> fandt jeg <a href="http://onethingwell.org/post/27835796928/remote-ssh-bact-to-my-mac">svaret</a>. :)</p>
<p>Herefter skrev jeg mit eget lille script, som håndterer det tunge arbejde med at identificere iCloud-id'et og forbinde korrekt.</p>
<p>Kør det sådan her:</p>
<div class="codehilite"><pre><span></span>./sshtomymac.sh [navn-på-mac]
</pre></div>


<p>eller bare:</p>
<div class="codehilite"><pre><span></span>./sshtomymac.sh
</pre></div>


<hr />
<p>Scriptet:</p>
<div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nv">ACCOUNT</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;show Setup:/Network/BackToMyMac&quot;</span> <span class="p">|</span> scutil <span class="p">|</span> sed -n <span class="s1">&#39;s/.* : *\(.*\).$/\1/p&#39;</span><span class="k">)</span>

<span class="k">if</span> <span class="o">[</span> ! -n <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;ssh to which Mac? &quot;</span>
    <span class="nb">read</span> MAC

    <span class="c1"># Uncomment the following two lines if you need to login to the remote host with a different user than the current local user.</span>
    <span class="c1">#echo &quot;As who? &quot;</span>
    <span class="c1">#read USER</span>

    <span class="k">if</span> <span class="o">[[</span> USER <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
        ssh <span class="nv">$USER</span><span class="s2">&quot;@&quot;</span><span class="nv">$MAC</span><span class="s2">&quot;.&quot;</span><span class="nv">$ACCOUNT</span>
        <span class="k">else</span>
        ssh <span class="nv">$MAC</span><span class="s2">&quot;.&quot;</span><span class="nv">$ACCOUNT</span>
    <span class="k">fi</span>
<span class="k">else</span>
    ssh <span class="nv">$1</span><span class="s2">&quot;.&quot;</span><span class="nv">$ACCOUNT</span>
<span class="k">fi</span>
</pre></div>
    </div>
	<div class="navleft">
		<a rel="prev prefetch" href="/archive.html">&lsaquo;&nbsp; Til arkivet</a>
	</div>

        <div id="footer">
            <p>Kresten Jacobsen @ logiskhave</p><p>Udgivet under <a href="//log.logiskhave.dk/static/solipsistisk_licens.html">Solipsistisk Offentlig Licens</a></p>
        </div><!-- /footer -->
    </div><!-- /container -->
</body>
</html>