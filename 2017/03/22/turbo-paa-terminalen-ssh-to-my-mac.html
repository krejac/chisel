<!DOCTYPE html>
<html lang="da">
<head>
 <meta charset="utf-8">
 <title>Turbo p&aring; Terminalen - ssh To My Mac | k.jcbsn.dk</title>
 <meta name="description" content="Log ajourf&oslash;rt af Kresten Jacobsen.">
 <meta name="viewport" content="width=720">
 <link rel="icon" href="/static/favicon.ico">
 <link rel="apple-touch-icon" href="/static/apple-touch-icon.jpg"/>
 <link rel="stylesheet" href="/css/theme.css" type="text/css">
 <link rel="alternate" type="application/rss+xml" title="" href="/rss.xml">
</head>
<body>
    <div id="container">
        <div id="header">
            <h1><span>Jeg er</span> <a title="Kolofon" href="/colophon.html">Kresten Jacobsen.</a> <span>Dette er</span> <a title="Log" href="/"> min log.</a></h1>
        </div><!-- /header --><div class="post">
		<p class="date">marts 22, 2017</p>
    	<h2>
            
                Turbo p&aring; Terminalen - ssh To My Mac
            
        </h2>
       	<p><a href="http://en.wikipedia.org/wiki/Wikipedia:Too_long;_didn't_read">TL;DR</a> - Jeg har lavet et lille <a href="">script</a>, der tillader at man ssh'er tilbage til sin Mac uden at rode med routere, portforwarding ol. Alt det kræver er at Back To My Mac er aktiveret på begge maskiner.</p>
<p><img src="/static/20170322-icloud-icon-ssh.png" alt="iCloud+SSH" style="width: 200px;"></p>
<p>Nogle gange har jeg brug for at kunne forbinde til min hjemme-mac og har hidtil gjort det via 'screen sharing' via 'Back To My Mac'. Det virker egentligt også fint, men som oftest har jeg slet ikke brug for den grafiske brugergrænseflade som skærmdeling giver mig. Jeg har bare brug for en terminal-adgang. Derfor ville jeg faktisl helst ssh'e mig ind til min maskine. Men jeg gider ikke rigtig rode med 'port forwarding' og åbne (mere) op til mit hjemmenetværk i min router. Så jeg kom til at tænke på, om man mon ikke kunne udnytte Back To My Mac-forbindelsen til dette formål. Og jo, efter 10 sekunder på <a href="https://duckduckgo.com/?q=Remote+SSH+using+Back+To+My+Mac">duckduckgo</a> fandt jeg <a href="http://onethingwell.org/post/27835796928/remote-ssh-bact-to-my-mac">svaret</a>. :)</p>
<p>Herefter skrev jeg mit eget lille script, som håndterer det tunge arbejde med at identificere iCloud-id'et og forbinde korrekt.</p>
<p>Kør det sådan her:</p>
<pre><code>./sshtomymac.sh [navn-på-mac]
</code></pre>
<p>eller bare:</p>
<pre><code>./sshtomymac.sh
</code></pre>
<hr />
<p>Scriptet:</p>
<pre><code>:::bash
#!/bin/bash

ACCOUNT=$(echo "show Setup:/Network/BackToMyMac" | scutil | sed -n 's/.* : *\(.*\).$/\1/p')

if [ ! -n "$1" ]; then
    echo "ssh to which Mac? "
    read MAC

    # Uncomment the following two lines if you need to login to the remote host with a different user than the current local user.
    #echo "As who? "
    #read USER

    if [[ USER ]]; then
        ssh $USER"@"$MAC"."$ACCOUNT
        else
        ssh $MAC"."$ACCOUNT
    fi
else
    ssh $1"."$ACCOUNT
fi
</code></pre>
    </div>
	<div class="navleft">
		<a rel="prev prefetch" href="/archive.html">&lsaquo;&nbsp; Til arkivet</a>
	</div>

        <div id="footer">
            <p>Kresten Jacobsen @ logiskhave</p><p>Udgivet under <a href="/static/solipsistisk_licens.html">Solipsistisk Offentlig Licens</a></p>
        </div><!-- /footer -->
    </div><!-- /container -->
</body>
</html>