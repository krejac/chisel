<!DOCTYPE html>
<html lang="da">
<head>
 <meta charset="utf-8">
 <title>Python: Send mail
 | logiskhave</title>
 <meta name="description" content="Log ajourf&oslash;rt af Kresten Jacobsen.">
 <meta name="viewport" content="width=720">
 <link rel="icon" href="/static/favicon.ico">
 <link rel="apple-touch-icon" href="/static/apple-touch-icon.jpg"/>
 <link rel="stylesheet" href="/css/theme.css" type="text/css">
 <link rel="alternate" type="application/rss+xml" title="" href="/rss.xml">
</head>
<body>
    <div id="container">
        <div id="header">
            <h1><span>Jeg er</span> <a title="Kolofon" href="/colophon.html">Kresten Jacobsen.</a> <span>Dette er</span> <a title="Log" href="/"> min log.</a></h1>
        </div><!-- /header --><div class="post">
		<p class="date">24. November, 2015</p>
    	<h2>
            
                Python: Send mail

            
        </h2>
       	<p><strong><a href="http://en.wikipedia.org/wiki/Wikipedia:Too_long;_didn't_read">TL;DR</a></strong> - Det er lige gået op for mig, <em>hvor</em> nemt det egentligt er at sende en gmail med Python. Det må jeg lige få noteret...</p>
<p><img alt="Code..." src="https://log.logiskhave.dk/static/20141023_code.jpg" title="Code..." /></p>
<p>Nedenstående eksempel sender en email til 'user2@example.org' med en påmindelse om at medbringe en paraply (det kunne jo være en del af et script, der tjekkede sandsynligheden for regn. Ja, det skal jeg også have lavet...).</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">smtplib</span>

<span class="c1"># Credentials</span>
<span class="n">GMAIL_USERNAME</span> <span class="o">=</span> <span class="s1">&#39;user1@example.org&#39;</span>
<span class="n">GMAIL_PASSWORD</span> <span class="o">=</span> <span class="s1">&#39;xyz123!&#39;</span>

<span class="c1"># Contents (body_of_email can be either plaintext or html)</span>
<span class="n">email_subject</span> <span class="o">=</span> <span class="s1">&#39;Email subject goes here&#39;</span>
<span class="n">recipient</span> <span class="o">=</span> <span class="s1">&#39;user2@example.org&#39;</span>
<span class="n">body_of_email</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Dear XXX,&lt;br&gt;</span>
<span class="s2">Don&#39;t forget to bring an umbrella. It&#39;s going to be raining cats and dogs...&lt;br&gt;</span>
<span class="s2">&lt;br&gt;</span>
<span class="s2">See you soon.&lt;br&gt;</span>
<span class="s2">&lt;br&gt;</span>
<span class="s2">Sincerly,&lt;br&gt;</span>
<span class="s2">UNIVAC</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Establish secure connection, verify identity (you may have to create an app specific password if you - like me - have two factor authentification enabled).</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">,</span> <span class="mi">587</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">starttls</span><span class="p">()</span>
<span class="n">session</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">GMAIL_USERNAME</span><span class="p">,</span> <span class="n">GMAIL_PASSWORD</span><span class="p">)</span>

<span class="n">headers</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;from: &quot;</span> <span class="o">+</span> <span class="n">GMAIL_USERNAME</span><span class="p">,</span>
                       <span class="s2">&quot;subject: &quot;</span> <span class="o">+</span> <span class="n">email_subject</span><span class="p">,</span>
                       <span class="s2">&quot;to: &quot;</span> <span class="o">+</span> <span class="n">recipient</span><span class="p">,</span>
                       <span class="s2">&quot;mime-version: 1.0&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;content-type: text/html&quot;</span><span class="p">])</span>

<span class="n">content</span> <span class="o">=</span> <span class="n">headers</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\r\n\r\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">body_of_email</span>
<span class="n">session</span><span class="o">.</span><span class="n">sendmail</span><span class="p">(</span><span class="n">GMAIL_USERNAME</span><span class="p">,</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
</pre></div>


<p>Og da smtplib er implementeret i <a href="http://omz-software.com/pythonista/">Pythonista</a>, burde ovenstående eksempel virke der også. :)</p>
    </div>
	<div class="navleft">
		<a rel="prev prefetch" href="/archive.html">&lsaquo;&nbsp; Til arkivet</a>
	</div>

        <div id="footer">
            <p>Kresten Jacobsen @ logiskhave</p><p>Udgivet under <a href="//log.logiskhave.dk/static/solipsistisk_licens.html">Solipsistisk Offentlig Licens</a></p>
        </div><!-- /footer -->
    </div><!-- /container -->
</body>
</html>